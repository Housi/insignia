!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.insignia=e()}}(function(){return function e(t,n,r){function i(a,l){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t){"use strict";var n=e("./dom"),r=e("./text"),i=e("./events"),o=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","webkitBoxSizing","mozBoxSizing","boxSizing","padding","border"],a=20;t.exports=function(e){function t(){var e,t,n=f();for(t=0;t<o.length;t++)e=n[o[t]],void 0!==e&&null!==e&&(c.style[o[t]]=e);c.disabled="disabled",c.style.whiteSpace="pre",c.style.position="absolute",c.style.top=c.style.left="-9999em"}function l(){var t=e.value;if(t!==c.value){r(c,t);var n=c.offsetWidth+a;e.style.width=n+"px"}}function s(t){var n=t?"remove":"add";i[n](e,"keydown",l),i[n](e,"keyup",l),i[n](e,"input",l),i[n](e,"paste",l),i[n](e,"change",l)}function u(){s(!0),c.parentElement.removeChild(c),e.style.width=""}function f(){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle}var c=n("span");return document.body.appendChild(c),t(),s(),{remap:t,refresh:l,destroy:u}}},{"./dom":2,"./events":3,"./text":9}],2:[function(e,t){"use strict";t.exports=function(e,t){var n=document.createElement(e);return t&&(n.className=t),n}},{}],3:[function(e,t){(function(e){"use strict";function n(e,t,n,r){return e.addEventListener(t,n,r)}function r(e,t,n,r){return e.attachEvent("on"+t,l(e,t,n),r)}function i(e,t,n,r){return e.removeEventListener(t,n,r)}function o(e,t,n,r){return e.detachEvent("on"+t,s(e,t,n),r)}function a(t,n,r){return function(n){var i=n||e.event;i.target=i.target||i.srcElement,i.preventDefault=i.preventDefault||function(){i.returnValue=!1},i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=!0},r.call(t,i)}}function l(e,t,n){var r=s(e,t,n)||a(e,t,n);return d.push({wrapper:r,element:e,evt:t,fn:n}),r}function s(e,t,n){var r=u(e,t,n);if(r){var i=d[r].wrapper;return d.splice(r,1),i}}function u(e,t,n){var r,i;for(r=0;r<d.length;r++)if(i=d[r],i.element===e&&i.evt===t&&i.fn===n)return r}var f=n,c=i,d=[];e.addEventListener||(f=r),e.removeEventListener||(c=o),t.exports={add:f,remove:c}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t){"use strict";function n(e){var t,n;for(n=0;n<S.length;n++)if(t=S[n],t.el===e)return t.api;return null}function r(e,t){function r(t){var n=t?"remove":"add";l[n](e,"keydown",B),l[n](e,"paste",F),l[n](_,"click",T),l[n](document.documentElement,"blur",k,!0)}function N(){return r(!0),e.value=M(),e.className=e.className.replace(E,""),_.className=_.className.replace(w,""),U.parentElement.removeChild(U),W.parentElement.removeChild(W),S.splice(S.indexOf(H),1),V.destroy(),G.destroyed=!0,G.destroy=O(G),G.tags=G.value=O(null),G}function O(e){return function(){return e}}function k(t){function n(e,t){U.appendChild(t)}t.target===e&&(z([" "],!0),j(W,n))}function T(t){var n=t.target;C.test(n.className)?L(n.parentElement,{start:"end",end:"end",remove:!0}):x.test(n.className)?L(n,b):n!==e&&(L(W.lastChild,b),z([" "],!0),e.focus())}function B(t){var n,r=u(e),i=t.which||t.keyCode||t.charCode;if(i===v)n=e.value.slice(0,r.start),z(c.test(n)?null:[" "]);else if(i===m)U.firstChild?L(U.firstChild,{}):u(e,{start:0,end:0});else if(i===g)W.lastChild?L(W.lastChild,b):u(e,b);else if(i===h&&0===r.start&&U.lastChild)L(U.lastChild,b);else if(i!==p||0!==r.start||0!==r.end&&r.end===e.value.length||!U.lastChild){if(i!==y||r.end!==e.value.length||!W.firstChild)return;L(W.firstChild,{})}else L(U.lastChild,b);return t.preventDefault(),!1}function F(){setTimeout(function(){z()},0)}function z(t,n){var r=u(e),i=n?1/0:r.start,o=e.value.slice(0,i).concat(t||[]).split(" ");if(!(o.length<1)){var a,l=o.pop()+e.value.slice(i),s=o.join(" ").length;for(a=0;a<o.length;a++)D(U,o[a]);A(),e.value=l,r.start-=s,r.end-=s,u(e,r),V.refresh()}}function A(){function e(e,n){-1!==t.indexOf(e)?n.parentElement.removeChild(n):t.push(e)}var t=[];j(U,e),j(W,e)}function D(e,t){var n=t.trim();if(0!==n.length){var r=i("span","nsg-tag");o(r,n),$.deletion&&r.appendChild(i("span","nsg-tag-remove")),e.appendChild(r)}}function L(t,n){if(t){z([" "],!0);var r=t.parentElement;if(r===U)for(;r.lastChild!==t;)W.insertBefore(r.lastChild,W.firstChild);else for(;r.firstChild!==t;)U.appendChild(r.firstChild);t.parentElement.removeChild(t),e.value=n.remove?"":o(t),e.focus(),u(e,n),V.refresh()}}function q(){var t,n=e.parentElement.children;for(t=0;t<n.length;t++)if(n[t]!==e&&n[t].nodeType===d)return!0;return!1}function j(e,t){var n,r,i=a(e.children);for(n=0;n<i.length;n++)r=i[n],t(o(r).trim(),r,n)}function I(){function t(e){e&&-1===r.indexOf(e)&&r.push(e)}var n,r=[],i=e.value.split(" ");for(j(U,t),n=0;n<i.length;n++)t(i[n]);return j(W,t),r}function M(){return I().join(" ")}var R=n(e);if(R)return R;var $=t||{},P=q(e);if(P||!f.test(e.tagName))throw new Error("Insignia expected an input element without any siblings.");var U=i("span","nsg-tags nsg-tags-before"),W=i("span","nsg-tags nsg-tags-after"),_=e.parentElement;e.className+=" nsg-input",_.className+=" nsg-editor",_.insertBefore(U,e),_.insertBefore(W,e.nextSibling),r();var V=s(e),G={tags:I,value:M,destroy:N},H={el:e,api:G};return z([" "],!0),S.push(H),G}e("./polyfills/String.prototype.trim"),e("./polyfills/Array.prototype.indexOf");var i=e("./dom"),o=e("./text"),a=e("./slice"),l=e("./events"),s=e("./autosize"),u=e("./selection"),f=/^input$/i,c=/^\s*$/,d=1,p=8,v=32,g=35,m=36,h=37,y=39,x=/\bnsg-tag\b/,C=/\bnsg-tag-remove\b/,w=/\bnsg-editor\b/g,E=/\bnsg-input\b/g,b={start:"end",end:"end"},S=[];t.exports=r},{"./autosize":1,"./dom":2,"./events":3,"./polyfills/Array.prototype.indexOf":5,"./polyfills/String.prototype.trim":6,"./selection":7,"./slice":8,"./text":9}],5:[function(){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(void 0===this||null===this)throw new TypeError;var n=this.length;for(t=+t||0,1/0===Math.abs(t)?t=0:0>t&&(t+=n,0>t&&(t=0));n>t;t++)if(this[t]===e)return t;return-1})},{}],6:[function(){"use strict";if(!String.prototype.trim){var e=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(e,"")}}},{}],7:[function(e,t){"use strict";function n(e){return{start:e.selectionStart,end:e.selectionEnd}}function r(e){function t(t,r){return n!==e&&(n?n.focus():e.blur()),{start:t,end:r}}var n=document.activeElement;n!==e&&e.focus();var r=document.selection.createRange(),a=r.getBookmark(),l=e.value,s=i(l),u=r.parentElement();if(null===u||!o(u))return t(0,0);r.text=s+r.text+s;var f=e.value;return e.value=l,r.moveToBookmark(a),r.select(),t(f.indexOf(s),f.lastIndexOf(s)-s.length)}function i(e){var t;do t="@@marker."+Math.random()*new Date;while(-1!==e.indexOf(t));return t}function o(e){return d.test(e.tagName)&&"text"===e.type||p.test(e.tagName)}function a(e,t){e.selectionStart=s(e,t.start),e.selectionEnd=s(e,t.end)}function l(e,t){var n=e.createTextRange();"end"===t.start&&"end"===t.end?(n.collapse(!1),n.select()):(n.collapse(!0),n.moveEnd("character",t.end),n.moveStart("character",t.start),n.select())}function s(e,t){return"end"===t?e.value.length:t||0}function u(e,t){return 2===arguments.length&&c(e,t),f(e)}var f=n,c=a,d=/input/i,p=/textarea/i;document.selection&&document.selection.createRange&&(f=r,c=l),t.exports=u},{}],8:[function(e,t){"use strict";function n(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e[t]);return n}t.exports=n},{}],9:[function(e,t){"use strict";function n(e,t){return 2===arguments.length&&(e.innerText=e.textContent=t),"string"==typeof e.innerText?e.innerText:e.textContent}t.exports=n},{}]},{},[4])(4)});